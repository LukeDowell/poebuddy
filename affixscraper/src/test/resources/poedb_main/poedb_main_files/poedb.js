function getUrlVars(){var t=[];if(-1==window.location.href.indexOf("?"))return t;for(var e=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<e.length;n++){var a=e[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}function getURLParameter(t,e){return(RegExp("[?&]"+e+"=(.+?)(&|$)").exec(t)||[,null])[1]}function getURLFilename(t){return"string"!=typeof t?"":((t=t.substring(t.lastIndexOf("/")+1)).match(/[^.]+(\.[^?#]+)?/)||[])[0]}function getFilenameValid(t){var e=getURLFilename(t),n=getURLParameter(t,"n");return jQuery.inArray(e,["gem.php","unique.php","item.php","skilltree.php","mon.php","quest.php"])>-1&&void 0!=n&&null!=n}function notify(t,e){Lobibox.notify("default",{size:"normal",title:t,msg:e})}function run_countdown(){$("[data-countdown]").each(function(){var t=$(this),e=getDate($(this).data("countdown")),n=$(this).data("format");t.countdown(e,function(e){if("day"==n)t.html(e.strftime("%Dd %Hh %Mm %Ss"));else{var a=24*e.offset.totalDays+e.offset.hours;t.html(e.strftime(a+"h %Mm %Ss"))}})})}function pad(t,e){for(var n=""+t;n.length<e;)n="0"+n;return n}function getDate(t){return new Date(1e3*t).YYYYMMDDHHMMSS()}var runQuery,queryString;function tableSearch(){$("input[name=query]").bind("focus",function(){$(this).css("background-color","#FFFFAA")}),$("input[name=query]").bind("blur",function(){$(this).css("background-color","")}),$("input[name=query]").bind("keydown keypress keyup",function(){queryString=$(this).val(),clearTimeout(runQuery),runQuery=setTimeout(function(){tableScreen(queryString)},200)}),$(".tags span").click(function(){var t=$("input[name=query]");queryString=""===t.val()?$(this).text():t.val()+" "+$(this).text(),t.val(queryString),tableScreen(t.val())}),$("input[type=reset]").click(function(){$("input[name=query]").val(""),tableScreen("")})}function tableScreen(t){if(""===queryString)$("table.filters tbody tr").show(),location.hash="";else{var e=t.split(" ");$("table.filters tbody tr").each(function(){for($(this).show(),i=0;i<e.length;++i)-1===$(this).children("td").text().toLowerCase().indexOf(e[i].toLowerCase())&&($(this).data("tags")?-1===$(this).data("tags").toLowerCase().indexOf(e[i].toLowerCase())&&$(this).hide():$(this).hide())}),location.hash="#"+t}}$(document).ready(function(){$("a.xyz_user").each(function(){$(this).qtip({content:{text:$(this).next(".tooltiptext"),title:{text:"快速購買",button:"Close"}},show:{solo:!0,modal:{on:!1,blur:!1}},style:{classes:"qtip-light"},hide:!1})})}),$(document).ready(function(){$("span.xyz_verify").click(function(){$(this).text("檢查中"),$.ajax({url:"xyz_verify.php",data:"thread="+$(this).attr("data-thread")+"&hash="+$(this).attr("data-hash"),type:"GET",dataType:"json",success:function(t){"已售出"==t.check?$("span[data-hash='"+t.hash+"']").css("color","red"):"未售出"==t.check&&$("span[data-hash='"+t.hash+"']").css("color","green"),$("span[data-hash='"+t.hash+"']").text(t.check)}})}),$("span.watch-btn").click(function(){$.ajax({url:"xyz_watch.php",data:"hash="+$(this).attr("data-hash"),type:"GET",dataType:"json",success:function(t){notify(t.title,t.hash)}})})}),$(document).ready(function(){"poedb.tw"!=window.location.hostname&&"cb.poedb.tw"!=window.location.hostname&&(window.location.href="http://poedb.tw/")}),$(document).ready(function(){$("table.table-clickable tr td").click(function(){"lightblue"==$(this).css("background-color")?$(this).css("background-color","white"):$(this).css("background-color","lightblue")})}),jQuery.fn.sortElements=function(){var t=[].sort;return function(e,n){n=n||function(){return this};var a=this.map(function(){var t=n.call(this),e=t.parentNode,a=e.insertBefore(document.createTextNode(""),t.nextSibling);return function(){if(e===this)throw new Error("You can't sort elements if any one is a descendant of another.");e.insertBefore(this,a),e.removeChild(a)}});return t.call(this,e).each(function(t){a[t].call(n.call(this))})}}(),$(document).ready(function(){$(".sortable").click(function(){var t=$(this).data("name");$("#xyz_items >tbody > tr").sortElements(function(e,n){var a=0;0<$(e).find("span[data-name='"+t+"']").length&&(a=1*$(e).find("span[data-name='"+t+"']").data("value"));var i=0;return 0<$(n).find("span[data-name='"+t+"']").length&&(i=1*$(n).find("span[data-name='"+t+"']").data("value")),a>i?-1:1},function(){return this}),$("html, body").animate({scrollTop:200},"slow")})}),Date.prototype.YYYYMMDDHHMMSS=function(){return this.getFullYear().toString()+"-"+pad(this.getMonth()+1,2)+"-"+pad(this.getDate(),2)+" "+pad(this.getHours(),2)+":"+pad(this.getMinutes(),2)+":"+pad(this.getSeconds(),2)};